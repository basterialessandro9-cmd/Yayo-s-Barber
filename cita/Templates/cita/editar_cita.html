{% load static %}

<h2>Editar Cita</h2>

<form method="POST">
    {% csrf_token %}

    <!-- Cliente: desplegable solo si lo estÃ¡s editando como admin -->
    <label for="cliente">Cliente:</label>
    <select name="cliente" id="cliente" required>
        {% for cliente in clientes %}
            <option value="{{ cliente.id }}" {% if cliente.id == cita.cliente.id %}selected{% endif %}>
                {{ cliente.user.get_full_name }}
            </option>
        {% endfor %}
    </select>
    <br><br>

    <!-- Fecha y hora de la cita -->
    <label for="fecha_hora">Fecha y Hora:</label>
    <input type="datetime-local" name="fecha_hora" id="fecha_hora" 
           value="{{ cita.fecha_hora|date:'Y-m-d\\TH:i' }}" required>
    <br><br>

    <!-- Servicio asociado a la cita -->
    <label for="servicio">Servicio:</label>
    <select name="servicio" id="servicio" required>
        {% for servicio in servicios %}
            <option value="{{ servicio.id }}" {% if servicio.id == cita.servicio.id %}selected{% endif %}>
                {{ servicio.nombre }}
            </option>
        {% endfor %}
    </select>
    <br><br>

    <!-- Estado de la cita -->
    <label for="estado">Estado:</label>
    <select name="estado" id="estado" required>
        {% for key, value in cita._meta.get_field('estado').choices %}
            <option value="{{ key }}" {% if key == cita.estado %}selected{% endif %}>{{ value }}</option>
        {% endfor %}
    </select>
    <br><br>

    <input type="submit" value="Guardar Cambios" class="btn-gold">
</form>
